<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>GUAâ€™Ä¨ APP | Presupuesto TÃ©cnico</title>

<link rel="manifest" href="manifiesto.json">
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>

<style>
body{margin:0;font-family:Arial;background:#f4f6f8}
.container{max-width:800px;margin:auto;background:#fff}
.header{background:#0b5ed7;color:#fff;text-align:center;padding:16px}
.header img{height:70px}
.card{margin:16px;padding:16px;border-radius:10px;box-shadow:0 2px 6px rgba(0,0,0,.1)}
input{width:100%;padding:8px;margin-top:6px}
button{width:100%;padding:14px;margin-top:10px;border:none;border-radius:8px;font-weight:bold}
.blue{background:#0b5ed7;color:#fff}
.green{background:#28a745;color:#fff}
.gray{background:#6c757d;color:#fff}
.footer{text-align:center;font-size:11px;color:#444;padding:20px}
.hidden{display:none}

/* PDF */
#pdf{width:210mm;min-height:297mm;padding:20mm;background:#fff}
#pdf table{width:100%;border-collapse:collapse;font-size:12px}
#pdf th,#pdf td{border:1px solid #333;padding:6px}
</style>
</head>

<body>

<div class="container">

<div class="header">
  <img src="logotipo-guaiapp.png">
  <div>PRESUPUESTO TÃ‰CNICO DE CLIMATIZACIÃ“N</div>
</div>

<div class="card">
  <input id="cliente" placeholder="Cliente">
  <input id="rucCliente" placeholder="RUC Cliente">
  <input id="telCliente" placeholder="TelÃ©fono Cliente">
  <input id="tecnico" placeholder="TÃ©cnico Responsable">
  <input id="telTecnico" placeholder="TelÃ©fono TÃ©cnico">
  <input id="empresa" placeholder="Empresa / Taller">
</div>

<div class="card">
  <input id="s1" placeholder="Mantenimiento preventivo Gs">
  <input id="s2" placeholder="Mantenimiento correctivo Gs">
  <input id="s3" placeholder="Carga de gas Gs">
  <input id="desc4" placeholder="Otro servicio">
  <input id="s4" placeholder="Precio otro servicio Gs">
</div>

<div class="card">
  <div><b>Subtotal:</b> Gs. <span id="sub">0</span></div>
  <div><b>IVA 10%:</b> Gs. <span id="iva">0</span></div>
  <div style="font-size:18px"><b>Total:</b> Gs. <span id="total">0</span></div>
</div>

<div class="card">
  <button class="blue" onclick="calcular()">Calcular</button>
  <button class="green" onclick="exportPDF()">Descargar PDF Profesional</button>
  <button class="green" onclick="enviarWhats()">Enviar por WhatsApp</button>
  <button id="btnInstalar" class="gray" style="display:none">Instalar App</button>
  <button class="gray" onclick="compartir()">Compartir App</button>
</div>

<div class="footer">
<b>GUAâ€™Ä¨ APP</b><br>
Desarrollado por <b>RHAB Tech</b> â€“ DivisiÃ³n de <b>RHAB INTERNATIONAL TRADING</b><br>
San Lorenzo â€“ Paraguay Â· Alberto SÃ¡nchez BenÃ­tez 9998<br>
ðŸ“§ guaiapp@rhabinternationaltrading.com
</div>

</div>

<!-- PDF -->
<div id="pdf" class="hidden">
<h3>Presupuesto TÃ©cnico</h3>
<p>NÂ°: <span id="pnum"></span><br>
Fecha: <span id="pfecha"></span><br>
VÃ¡lido hasta: <span id="pvence"></span></p>

<table>
<tr><td>Cliente</td><td id="pcliente"></td></tr>
<tr><td>RUC</td><td id="pruc"></td></tr>
<tr><td>TelÃ©fono</td><td id="ptel"></td></tr>
<tr><td>TÃ©cnico</td><td id="ptecnico"></td></tr>
<tr><td>Empresa</td><td id="pempresa"></td></tr>
</table>

<br>

<table>
<tr><th>DescripciÃ³n</th><th>Importe</th></tr>
<tr><td>Mantenimiento preventivo</td><td id="ps1"></td></tr>
<tr><td>Mantenimiento correctivo</td><td id="ps2"></td></tr>
<tr><td>Carga de gas</td><td id="ps3"></td></tr>
<tr><td id="pdesc4"></td><td id="ps4"></td></tr>
<tr><td><b>Subtotal</b></td><td id="psub"></td></tr>
<tr><td><b>IVA 10%</b></td><td id="piva"></td></tr>
<tr><td><b>Total</b></td><td id="ptotal"></td></tr>
</table>

<p><b>GarantÃ­a:</b> 7 dÃ­as sobre el servicio realizado.</p>

<p style="font-size:10px">
RHAB Tech â€“ RHAB INTERNATIONAL TRADING<br>
San Lorenzo â€“ Paraguay Â· Alberto SÃ¡nchez BenÃ­tez 9998<br>
guaiapp@rhabinternationaltrading.com
</p>
</div>

<script>
function calcular(){
  let total=(+s1.value||0)+(+s2.value||0)+(+s3.value||0)+(+s4.value||0);
  let sub=total/1.1;
  let iva=total-sub;
  sub=Math.round(sub); iva=Math.round(iva);

  document.getElementById("sub").innerText=sub.toLocaleString("es-PY");
  document.getElementById("iva").innerText=iva.toLocaleString("es-PY");
  document.getElementById("total").innerText=total.toLocaleString("es-PY");
}

function exportPDF(){
  calcular();
  let n="GUA-"+Date.now();
  let f=new Date(); let v=new Date(); v.setDate(f.getDate()+7);

  pnum.innerText=n;
  pfecha.innerText=f.toLocaleDateString();
  pvence.innerText=v.toLocaleDateString();

  pcliente.innerText=cliente.value;
  pruc.innerText=rucCliente.value;
  ptel.innerText=telCliente.value;
  ptecnico.innerText=tecnico.value;
  pempresa.innerText=empresa.value;

  ps1.innerText=s1.value;
  ps2.innerText=s2.value;
  ps3.innerText=s3.value;
  pdesc4.innerText=desc4.value;
  ps4.innerText=s4.value;

  psub.innerText=sub.innerText;
  piva.innerText=iva.innerText;
  ptotal.innerText=total.innerText;

  pdf.classList.remove("hidden");
  html2pdf().from(pdf).save("Presupuesto_"+n+".pdf").then(()=>pdf.classList.add("hidden"));
}

function enviarWhats(){
  calcular();
  let msg=`Presupuesto GUAâ€™Ä¨ APP\nCliente: ${cliente.value}\nTotal: Gs. ${total.innerText}`;
  window.open("https://wa.me/?text="+encodeURIComponent(msg));
}

function compartir(){
  if(navigator.share){
    navigator.share({title:"GUAâ€™Ä¨ APP",url:location.href});
  }else alert("Compartir no disponible");
}

// PWA
let deferredPrompt;
window.addEventListener("beforeinstallprompt",e=>{
  e.preventDefault();
  deferredPrompt=e;
  btnInstalar.style.display="block";
});
btnInstalar.onclick=()=>{deferredPrompt.prompt();};

// SW
if("serviceWorker"in navigator){navigator.serviceWorker.register("sw.js");}
</script>

</body>
</html>
