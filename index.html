<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>GUAâ€™Ä¨ APP | Presupuesto TÃ©cnico</title>

<link rel="manifest" href="manifiesto.json">
<meta name="theme-color" content="#0b5ed7">

<script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>

<style>
:root{ --primary:#0b5ed7; --green:#28a745; --gray:#6c757d; --bg:#f4f6f8; }
body{ margin:0; font-family:system-ui,Arial; background:var(--bg); }

#app-container{
  max-width:800px;
  margin:0 auto;
  background:#fff;
}

.header{
  background:var(--primary);
  color:#fff;
  text-align:center;
  padding:20px;
}
.header img{ width:240px; }

.container{ padding:20px; }

.card{
  background:#fff;
  border-radius:12px;
  padding:16px;
  margin-bottom:16px;
  box-shadow:0 2px 6px rgba(0,0,0,.08);
}

h2{ color:var(--primary); font-size:16px; margin:0 0 10px 0; }

input{
  width:100%;
  padding:10px;
  margin-top:6px;
  border-radius:8px;
  border:1px solid #ccc;
}

.service-row{
  display:flex;
  gap:10px;
  align-items:center;
  margin-top:10px;
}
.service-desc{ flex:1; }
.service-price{ width:120px; }

.total-box{
  margin-top:15px;
  border-top:1px solid #eee;
  padding-top:10px;
}
.total{ font-size:18px; font-weight:bold; }

.btn{
  width:100%;
  padding:14px;
  border:none;
  border-radius:10px;
  margin-top:10px;
  font-weight:600;
  cursor:pointer;
}
.btn-blue{ background:var(--primary); color:#fff; }
.btn-green{ background:var(--green); color:#fff; }
.btn-gray{ background:var(--gray); color:#fff; }

.footer{
  text-align:center;
  font-size:11px;
  color:#444;
  padding:20px;
  border-top:1px solid #ddd;
}

.pdf-bg{ background:#fff !important; }
</style>
</head>

<body>

<div id="app-container">

<div class="header">
  <img src="logotipo-guaiapp.png">
  <div>PRESUPUESTO TÃ‰CNICO DE CLIMATIZACIÃ“N</div>
</div>

<div class="container">

<div class="card">
  <b>NÂ° Presupuesto:</b> <span id="numPresupuesto"></span><br>
  <b>Fecha emisiÃ³n:</b> <span id="fecha"></span><br>
  <b>VÃ¡lido hasta:</b> <span id="vencimiento"></span>
</div>

<div class="card">
  <h2>Datos</h2>
  <input id="cliente" placeholder="Cliente">
  <input id="ruc" placeholder="RUC / CI Cliente">
  <input id="tecnico" placeholder="TÃ©cnico responsable">
  <input id="empresa" placeholder="Empresa / Taller">
</div>

<div class="card">
  <h2>Servicios</h2>

  <div class="service-row"><input type="checkbox">
    <div class="service-desc">Mantenimiento preventivo</div>
    <input id="s1" class="service-price" type="number"></div>

  <div class="service-row"><input type="checkbox">
    <div class="service-desc">Mantenimiento correctivo</div>
    <input id="s2" class="service-price" type="number"></div>

  <div class="service-row"><input type="checkbox">
    <div class="service-desc">Carga de gas</div>
    <input id="s3" class="service-price" type="number"></div>

  <div class="service-row"><input type="checkbox">
    <div class="service-desc">
      Otro servicio<br>
      <input id="desc_otro" placeholder="DescripciÃ³n">
    </div>
    <input id="s4" class="service-price" type="number"></div>

  <div class="total-box">
    <div class="total">Total: Gs. <span id="total">0</span></div>
    IVA (10%) incluido: Gs. <span id="iva">0</span>
  </div>
</div>

<div class="card" data-html2canvas-ignore="true">
  <button class="btn btn-blue" onclick="calc()">Actualizar total</button>
  <button class="btn btn-green" onclick="downloadPDF()">Descargar PDF</button>
  <button class="btn btn-green" onclick="sendWhats()">Enviar por WhatsApp</button>
</div>

</div>

<div class="footer">
<b>GarantÃ­a:</b> 7 dÃ­as sobre el servicio realizado. No incluye repuestos.<br><br>

<b>RHAB Tech</b> â€“ DivisiÃ³n TecnolÃ³gica de<br>
<b>RHAB INTERNATIONAL TRADING</b><br>
San Lorenzo â€“ Paraguay<br>
Alberto SÃ¡nchez BenÃ­tez 9998<br>
Barrio Las Mercedes<br><br>
ðŸ“§ guaiapp@rhabinternationaltrading.com<br>
ðŸ“§ info@rhabinternationaltrading.com
</div>

</div>

<script>
function generarNumero(){
 let c = Number(localStorage.getItem("guai_cont")||0)+1;
 localStorage.setItem("guai_cont",c);
 let f = new Date();
 return `GUA-${f.getFullYear()}${(f.getMonth()+1).toString().padStart(2,"0")}${f.getDate().toString().padStart(2,"0")}-${c.toString().padStart(4,"0")}`;
}

const hoy = new Date();
const venc = new Date(hoy); venc.setDate(hoy.getDate()+7);

numPresupuesto.innerText = generarNumero();
fecha.innerText = hoy.toLocaleDateString();
vencimiento.innerText = venc.toLocaleDateString();

function calc(){
 let sum=0;
 ["s1","s2","s3","s4"].forEach(id=>{
   let v=Number(document.getElementById(id).value||0);
   sum+=v;
 });
 total.innerText=sum.toLocaleString("es-PY");
 iva.innerText=Math.round(sum/11).toLocaleString("es-PY");
}

function downloadPDF(){
 document.getElementById("app-container").classList.add("pdf-bg");
 html2pdf().from(document.getElementById("app-container")).save();
}

function sendWhats(){
 let msg=`*PRESUPUESTO ${numPresupuesto.innerText}*\nCliente: ${cliente.value}\nRUC: ${ruc.value}\nTotal: Gs. ${total.innerText}\nVÃ¡lido hasta: ${vencimiento.innerText}\nGarantÃ­a: 7 dÃ­as`;
 window.open("https://wa.me/?text="+encodeURIComponent(msg));
}

if("serviceWorker" in navigator){ navigator.serviceWorker.register("sw.js"); }
</script>

</body>
</html>
